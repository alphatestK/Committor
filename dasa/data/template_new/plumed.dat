#! vim:ft=plumed

# input file for unbiased dasa reaction 

#UNITS
UNITS LENGTH=A

# load interface for bias computation
#LOAD FILE=../../../pytorch_model_bias.cpp
LOAD FILE=../../../pytorch_model_bias.so

ene: ENERGY
cell: CELL

# ==== GROUPS ====
C: GROUP ATOMS=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
N: GROUP ATOMS=16
O: GROUP ATOMS=17,18,19,20,21
H: GROUP ATOMS=22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42

# ==== DISTANCES =====
INCLUDE FILE=../plumed_distances.dat

# ==== POSITIONS =====
INCLUDE FILE=../plumed_positions.dat

# ==== COMPUTE COMMITTOR GUESS FOR BIAS ====
q: PYTORCH_MODEL_BIAS FILE=../../model.pt ARG=x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18,x19,x20,x21,x22,x23,x24,x25,x26,x27,x28,x29,x30,x31,x32,x33,x34,x35,x36,x37,x38,x39,x40,x41,x42,x43,x44,x45 LAMBDA=lambda EPSILON=1e-7

# this is the total bias
bias: CUSTOM ARG=q.bias-0 var=a PERIODIC=NO FUNC=-a

potential: BIASVALUE ARG=bias


# ==== PRINT STUFF ====
PRINT FILE=COLVAR ARG=* STRIDE=20
